# Practice 1 - Triggers
This folder contains the solution for the following exercices done in the first practice of the subject **Database Management Systems**.

## Base tables
In each scheme two tables will have to be created because they contain information on rivers and countries,
both related through foreign keys to know the places where they are born and flow. The tables will follow the following logical schemes:

- TABLE **RIOS**

| Column          | Type          | PK  | NN  | UNI | CHK | FK  | COMMENTS        |
|-----------------|---------------|-----|-----|-----|-----|-----|-----------------|
| ID_RIO          | NUMBER        | YES |     |     |     |     |                 |
| NOMBRE          | VARCHAR2(100) |     | YES |     |     |     |                 |
| LONGITUD        | NUMBER        |     |     |     |     |     |                 |
| CUENCA          | NUMBER        |     |     |     |     |     |                 |
| CAUDAL_MEDIO    | NUMBER        |     |     |     |     |     |                 |
| NACIMIENTO      | VARCHAR2(64)  |     | YES |     |     |     |                 |
| PAIS_NACIMIENTO | NUMBER        |     | YES |     |     | YES | PAISES(ID_PAIS) |
| DESEMBOCADURA   | VARCHAR2(64)  |     | YES |     |     |     |                 |
| PAIS_DESEMBOC   | NUMBER        |     | YES |     |     | YES | PAISES(ID_PAIS) |

- TABLE **PAISES**

| Column     | Type          | PK  | NN  | UNI | CHK | FK | COMMENTS |
|------------|---------------|-----|-----|-----|-----|----|----------|
| ID_PAIS    | NUMBER        | YES |     |     |     |    |          |
| NOMBRE     | VARCHAR2(64)  |     | YES |     |     |    |          |
| CONTINENTE | VARCHAR2(24)  |     | YES |     |     |    |          |
| CAPITAL    | VARCHAR2(64)  |     | YES |     |     |    |          |
| SITUACION  | VARCHAR2(128) |     |     |     |     |    |          |
| NOTAS      | VARCHAR2(128) |     |     |     |     |    |          |


## Exercices

**EJ1.** Create the tables defined above and fill them with test data.

**EJ2.** Implement a PL / SQL trigger that prevents records from being inserted or modified in the RIOS table, assigning them a negative or excessively large length. Do the same with CAUDAL. Check the operation of the trigger by performing the following tasks: 
- a) Insert a new value in RIOS with an allowed length (INSERT) and consult the table to check that the insertion has worked (SELECT).
- b) Modify a value in RIOS with an unauthorized length (UPDATE) and show the error generated by the DBMS.
- c) Disable the trigger (SQL statement) created. 
- d) Repeat the modification operation and consult the table to check that the incorrect length data has been inserted (SELECT).
- e) Enable the trigger (SQL statement).
- f) Execute a ROLLBACK to undo the transaction and comment on the result obtained.

**EJ3.** Implement a PL / SQL trigger that prevents records from being inserted or modified in the RIOS table by assigning them a country that is not in Europe.

**EJ4.** Include a new field in the PAISES table named NUM_RIOS to save the number of rivers flowing into that country, and implement a trigger to keep that NUM_RIOS field up to date in the PAISES table when the RIOS table undergoes any changes that affect its value.

**EJ5.** Implement one or more PL / SQL triggers that keep the CAMBIOLOG table up to date with the dates of the last 10 changes that have been made to the COUNTRIES and RIVERS tables. The name of the modified table and the date of the modification must be stored (use SYSDATE). Note: The CAMBIOLOG table must be defined and created.

**EJ6.** Implement a trigger that generates a mutant table problem and check its operation with an SQL statement.